"use strict";(self.webpackChunkaodocs=self.webpackChunkaodocs||[]).push([[339],{3905:(e,t,r)=>{r.d(t,{Zo:()=>h,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},h=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),c=u(r),m=a,p=c["".concat(s,".").concat(m)]||c[m]||d[m]||o;return r?n.createElement(p,i(i({ref:t},h),{},{components:r})):n.createElement(p,i({ref:t},h))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},8580:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var n=r(7462),a=(r(7294),r(3905));const o={},i="Hosting with tsuserver3",l={unversionedId:"Server/Tsuserver",id:"Server/Tsuserver",title:"Hosting with tsuserver3",description:"tsuserver3 is, currently, the only choice for simple server hosting. It\u2019s a fast, easy-to-setup server program that runs on Python. Most servers use it now, so commands and behavior will be very familiar when you switch from server to server.",source:"@site/docs/Server/Tsuserver.md",sourceDirName:"Server",slug:"/Server/Tsuserver",permalink:"/AODocs/Server/Tsuserver",draft:!1,editUrl:"https://github.com/AttorneyOnline/AODocs/tree/main/docs/Server/Tsuserver.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"So you want to write a new server?",permalink:"/AODocs/Server/Server Rewrite"},next:{title:"Documentation",permalink:"/AODocs/"}},s={},u=[{value:"Installing Python",id:"installing-python",level:2},{value:"Configuring the server",id:"configuring-the-server",level:2},{value:"<code>config.yaml</code>",id:"configyaml",level:3},{value:"Basic",id:"basic",level:4},{value:"webAO",id:"webao",level:4},{value:"Master server options",id:"master-server-options",level:4},{value:"Flood guards",id:"flood-guards",level:4},{value:"Internal use",id:"internal-use",level:4},{value:"<code>areas.yaml</code>",id:"areasyaml",level:3},{value:"<code>backgrounds.yaml</code>",id:"backgroundsyaml",level:3},{value:"<code>characters.yaml</code>",id:"charactersyaml",level:3},{value:"<code>iniswaps.yaml</code>",id:"iniswapsyaml",level:3},{value:"<code>music.yaml</code>",id:"musicyaml",level:3},{value:"Using the <code>characters/</code> folder",id:"using-the-characters-folder",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}],h={toc:u};function d(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},h,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"hosting-with-tsuserver3"},"Hosting with tsuserver3"),(0,a.kt)("p",null,"tsuserver3 is, currently, the only choice for simple server hosting. It\u2019s a fast, easy-to-setup server program that runs on Python. Most servers use it now, so commands and behavior will be very familiar when you switch from server to server."),(0,a.kt)("h2",{id:"installing-python"},"Installing Python"),(0,a.kt)("p",null,"Step one is to install the latest version of Python 3. The default settings will work fine, but you need to ",(0,a.kt)("strong",{parentName:"p"},"select Add Python 3 to PATH"),", like this fellow demonstrates:"),(0,a.kt)("p",null,"(TODO illustration)"),(0,a.kt)("p",null,"(yes this screenshot is outdated -- yours is probably going to be a much newer version)"),(0,a.kt)("p",null,"Now visit the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/AttorneyOnline/tsuserver3"},"tsuserver3 GitHub"),' and download the tsuserver3 zip with the "Clone or download" button. Extract it to your favorite folder. ',(0,a.kt)("strong",{parentName:"p"},"Do not put anything from AO in the server folder.")),(0,a.kt)("p",null,"You may wish to read the readme on GitHub for instructions on how to set up tsuserver and its prerequisites (as this documentation is not complete)."),(0,a.kt)("p",null,"Once that\u2019s done, your goal is ultimately to get a \u201cServer started\u201d message. But before that..."),(0,a.kt)("h2",{id:"configuring-the-server"},"Configuring the server"),(0,a.kt)("p",null,"You probably noticed that the readme mentioned something about editing the values of the configs to your liking. Sure enough, now that you have your own server, you have to customize it. Nobody wants another copy of Official Unofficial, do they?"),(0,a.kt)("p",null,"So open your freshly-renamed config folder and find six YAML files. You can open them with any normal text editor. Some of their options are self-explanatory; some of them are more vague. All of them are very particular. Follow the format strictly or it won\u2019t work. On names and other strings that contain symbols, put \u2018single quotes\u2019 around them to prevent pyYAML errors. Never use tab; indents in YAML are done with spaces only."),(0,a.kt)("p",null,"The following is a reference of each config file and what they specify:"),(0,a.kt)("h3",{id:"configyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"config.yaml")),(0,a.kt)("p",null,"Fortunately, this config comes with comments."),(0,a.kt)("h4",{id:"basic"},"Basic"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"hostname"),": Name that the server goes by when sending responses in the server OOC chat. Users will get an error when attempting to use this name, so that everyone knows server messages are actually coming from the server. ",(0,a.kt)("dollar",null)," is a universal AO placeholder for the $ sign and Hostnames often start with it."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"motd"),": The server sends this message in OOC chat when you connect."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"playerlimit"),": Total amount of players that can connect, across all areas."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"port"),": The one you forwarded. Make sure it matches the port-forward rule you set up."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"local <true/false>"),": Makes the server listen on your computer only. Keep false if you want others to be able to connect."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"modpass"),": The password you /login with to become moderator, which gives you access to powerful mod commands. Keep this secure.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"This advanced configuration allows you to set multiple passwords and give them to different users. Put it in the line under\nmodpass:",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"  mod1:\n    password: 'one password'\n  mod2:\n    password: 'a different password'\n")))))),(0,a.kt)("h4",{id:"webao"},"webAO"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"use_websockets <true/false>"),": Whether the server will open itself up for webAO users."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"websocket_port"),": The port that webAO users will connect with; cannot be the same as the normal port. This means if you\u2019re using websockets you need to forward two different ports.")),(0,a.kt)("h4",{id:"master-server-options"},"Master server options"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"use_masterserver <true/false>"),": Whether the server will add itself to the public server list when starting up. Set false for a private server. Your friends will then have to add entries in serverlist.txt with your server\u2019s ip, port, and name."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"masterserver_ip"),": Keep this as master.aceattorneyonline.com"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"masterserver_port"),": Keep this as 27016"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"masterserver_name"),": The name your server will have on the public server list."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"masterserver_description"),": The description your server will have in the description box.")),(0,a.kt)("h4",{id:"flood-guards"},"Flood guards"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"music_change_floodguard"),"/",(0,a.kt)("inlineCode",{parentName:"li"},"wtce_floodguard"),": Settings to stop music and judge sign spam, respectively:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"times_per_interval"),": Amount of requests in an interval of time required to trigger mute, stopping them from changing music/using judge signs."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"interval_length"),": Length in seconds of the interval."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"mute_length"),": Length in seconds of the mute.")))),(0,a.kt)("h4",{id:"internal-use"},"Internal use"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"timeout"),": How long a client can stay on without sending a keepalive packet. Guards against background Internet traffic and zombies. Keep at the default value (250) unless you know what you\u2019re doing."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"debug <true/false>"),": Turns on advanced logging in debug.log, which is used to diagnose problems. I would keep it true for long sessions unless you have space limitations, so you don\u2019t miss anything when a problem occurs.")),(0,a.kt)("h3",{id:"areasyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"areas.yaml")),(0,a.kt)("p",null,"Your chatrooms where all the fun goes down. Configured with a series of area entries that start with their name."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"area"),": The area\u2019s name."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"background"),": The name of the background that this area will start with. Should be one of the options in backgrounds.yaml."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"bglock <'true'/'false'>"),": Default setting for this area\u2019s background lock, which sets whether or not anyone can come in and change the background. HAS to be in 'single quotes' to apply correctly!"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"evidence_mod"),": Special keyword that determines who can change evidence in this area. See the readme."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"locking_allowed <true/false>"),": Whether users can lock this area for themselves and their buddies."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"iniswap_allowed <true/false>"),": Whether players can use the iniswapping \u201cglitch\u201d in this area, or send emotes not found in the characters/ folder (see below)")),(0,a.kt)("h3",{id:"backgroundsyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"backgrounds.yaml")),(0,a.kt)("p",null,"A list of background folder names that will be available for switching between. The actual background that each area starts with is set in ",(0,a.kt)("inlineCode",{parentName:"p"},"areas.yaml"),"."),(0,a.kt)("h3",{id:"charactersyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"characters.yaml")),(0,a.kt)("p",null,"A list of character folder names that will be loaded into your server\u2019s character menu."),(0,a.kt)("h3",{id:"iniswapsyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"iniswaps.yaml")),(0,a.kt)("p",null,"Exceptions to the iniswap_allowed setting. Shows which characters can be swapped out for each other."),(0,a.kt)("h3",{id:"musicyaml"},(0,a.kt)("inlineCode",{parentName:"h3"},"music.yaml")),(0,a.kt)("p",null,"Basically, a list of file names to go into the music list. tsuserver is fancy and does them in categories. For your own safety, put \u2018single quotes\u2019 around each song and category name to avoid errors."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"category"),": Text in the red line inside the music list that each of the following songs will appear under. You can put any ",(0,a.kt)("inlineCode",{parentName:"li"},"--~~||formatting||~~--")," you want to distinguish them further."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"songs"),": Paired -name and length entries for each song that goes into the category:"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"name"),": Name of the .mp3 file as it appears in sounds/music in your server\u2019s contents, e.g. \u2018Annonce the Truth(T&T).mp3\u2019"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"length"),": Length in seconds of the song, before it loops again. Set to 0 for no looping.")),(0,a.kt)("h2",{id:"using-the-characters-folder"},"Using the ",(0,a.kt)("inlineCode",{parentName:"h2"},"characters/")," folder"),(0,a.kt)("p",null,"tsuserver can now check if the emotes that players use in their messages are valid. If you give tsuserver a characters/ folder (like in the client) full of your char.inis, messages with invalid emotes will be rejected. Any characters that don\u2019t have a char.ini placed here and appear in your characters.yaml will be free to use any emote they have in their ini. You should already have the vanilla version of this folder with tsuserver."),(0,a.kt)("p",null,"To add new characters, you don't need to copy over the animations as well - just the ",(0,a.kt)("inlineCode",{parentName:"p"},"char.ini")," files."),(0,a.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.kt)("p",null,"If you double click ",(0,a.kt)("inlineCode",{parentName:"p"},"start_server.py")," and it immediately closes on you, it\u2019s probably a configuration problem. However, to be more certain about what the problem is, you can run it from the command line with ",(0,a.kt)("inlineCode",{parentName:"p"},"py -3 start_server.py")," to get the Python error output. This will tell you where the problem is coming from and what exactly it is. If you don\u2019t understand the error, you can get help in the Discord server."),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"This section was adapted from Trey's")," ",(0,a.kt)("a",{parentName:"p",href:"https://docs.google.com/document/d/1xOd7SDCBmSA0RM8M7JX7xACA4YUsQn72Bob9HBOzhVM/edit#"},"How to Server")," ",(0,a.kt)("em",{parentName:"p"},"guide.")))}d.isMDXComponent=!0}}]);